# Building amtest-run [riscv64-npc]
make -C /home/porterlu/ysyx-workbench/abstract-machine/am archive
make[1]: Entering directory '/home/porterlu/ysyx-workbench/abstract-machine/am'
# Building am-archive [riscv64-npc]
mkdir -p /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/riscv/npc/ && echo + CC src/riscv/npc/trm.c
+ CC src/riscv/npc/trm.c
riscv64-linux-gnu-gcc -std=gnu11 -O2 -MMD -Wall -Werror -I/home/porterlu/ysyx-workbench/abstract-machine/am/src -I/home/porterlu/ysyx-workbench/abstract-machine/am/include -I/home/porterlu/ysyx-workbench/abstract-machine/am/include/ -I/home/porterlu/ysyx-workbench/abstract-machine/klib/include/ -D__ISA__=\"riscv64\" -D__ISA_RISCV64__ -D__ARCH__=riscv64-npc -D__ARCH_RISCV64_NPC -D__PLATFORM__=npc -D__PLATFORM_NPC -DARCH_H=\"arch/riscv64-npc.h\" -fno-asynchronous-unwind-tables -fno-builtin -fno-stack-protector -Wno-main -U_FORTIFY_SOURCE -fno-pic -march=rv64g -mcmodel=medany -mstrict-align -static -fdata-sections -ffunction-sections -DMAINARGS=\"v\" -c -o /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/riscv/npc/trm.o /home/porterlu/ysyx-workbench/abstract-machine/am/src/riscv/npc/trm.c
echo + AR "->" build/am-riscv64-npc.a
+ AR -> build/am-riscv64-npc.a
ar rcs /home/porterlu/ysyx-workbench/abstract-machine/am/build/am-riscv64-npc.a /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/riscv/npc/start.o /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/riscv/npc/trm.o /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/riscv/npc/ioe.o /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/riscv/npc/timer.o /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/riscv/npc/input.o /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/riscv/npc/cte.o /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/riscv/npc/trap.o /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/riscv/npc/gpu.o /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/platform/dummy/vme.o /home/porterlu/ysyx-workbench/abstract-machine/am/build/riscv64-npc/src/platform/dummy/mpe.o
make[1]: Leaving directory '/home/porterlu/ysyx-workbench/abstract-machine/am'
make -C /home/porterlu/ysyx-workbench/abstract-machine/klib archive
make[1]: Entering directory '/home/porterlu/ysyx-workbench/abstract-machine/klib'
# Building klib-archive [riscv64-npc]
make[1]: Nothing to be done for 'archive'.
make[1]: Leaving directory '/home/porterlu/ysyx-workbench/abstract-machine/klib'
echo + LD "->" build/amtest-riscv64-npc.elf
+ LD -> build/amtest-riscv64-npc.elf
riscv64-linux-gnu-ld -melf64lriscv -T /home/porterlu/ysyx-workbench/abstract-machine/scripts/linker.ld --defsym=_pmem_start=0x80000000 --defsym=_entry_offset=0x0 --gc-sections -e _start -o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/amtest-riscv64-npc.elf --start-group /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/tests/keyboard.o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/tests/vm.o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/tests/rtc.o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/tests/audio.o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/tests/mp.o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/tests/video.o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/tests/audio/audio-data.o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/tests/devscan.o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/tests/hello.o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/tests/intr.o /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/riscv64-npc/src/main.o /home/porterlu/ysyx-workbench/abstract-machine/am/build/am-riscv64-npc.a /home/porterlu/ysyx-workbench/abstract-machine/klib/build/klib-riscv64-npc.a --end-group
echo \# Creating image [riscv64-npc]
# Creating image [riscv64-npc]
riscv64-linux-gnu-objdump -d /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/amtest-riscv64-npc.elf > /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/amtest-riscv64-npc.txt
echo + OBJCOPY "->" build/amtest-riscv64-npc.bin
+ OBJCOPY -> build/amtest-riscv64-npc.bin
riscv64-linux-gnu-objcopy -S --set-section-flags .bss=alloc,contents -O binary /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/amtest-riscv64-npc.elf /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/amtest-riscv64-npc.bin
make -C /home/porterlu/ysyx-workbench//myCPU IMG_BIN=/home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/amtest-riscv64-npc.bin IMG_FILE=/home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/amtest-riscv64-npc.elf SO_FILE=/home/porterlu/ysyx-workbench/nemu/build/riscv64-nemu-interpreter-so run
make[1]: Entering directory '/home/porterlu/ysyx-workbench/myCPU'
verilator -CFLAGS -I/usr/lib/llvm-11/include -CFLAGS -std=c++14 -CFLAGS -fno-exceptions -CFLAGS -D_GNU_SOURCE -CFLAGS -D__STDC_CONSTANT_MACROS -CFLAGS -D__STDC_FORMAT_MACROS -CFLAGS -D__STDC_LIMIT_MACROS -CFLAGS -fPIE -LDFLAGS -lLLVM-11 -LDFLAGS -lSDL2 --cc --build --exe --trace -Wno-lint -Mdir obj_dir --top-module myCPU -CFLAGS -I/home/porterlu/ysyx-workbench/myCPU/include -LDFLAGS -lreadline -LDFLAGS -ldl /home/porterlu/ysyx-workbench/myCPU/vsrc/myCPU.v /home/porterlu/ysyx-workbench/myCPU/vsrc/Mem.v /home/porterlu/ysyx-workbench/myCPU/vsrc/gpr_ptr.v /home/porterlu/ysyx-workbench/myCPU/csrc/main.cpp /home/porterlu/ysyx-workbench/myCPU/csrc/mmio.c /home/porterlu/ysyx-workbench/myCPU/csrc/sdb.c /home/porterlu/ysyx-workbench/myCPU/csrc/gpu.c /home/porterlu/ysyx-workbench/myCPU/csrc/timer.c /home/porterlu/ysyx-workbench/myCPU/csrc/state.c /home/porterlu/ysyx-workbench/myCPU/csrc/pmem.c /home/porterlu/ysyx-workbench/myCPU/csrc/reg.c /home/porterlu/ysyx-workbench/myCPU/csrc/log.c /home/porterlu/ysyx-workbench/myCPU/csrc/elftl.c /home/porterlu/ysyx-workbench/myCPU/csrc/vmem.c /home/porterlu/ysyx-workbench/myCPU/csrc/exec.c /home/porterlu/ysyx-workbench/myCPU/csrc/img.c /home/porterlu/ysyx-workbench/myCPU/csrc/serial.c /home/porterlu/ysyx-workbench/myCPU/csrc/difftest.c /home/porterlu/ysyx-workbench/myCPU/csrc/expr.c /home/porterlu/ysyx-workbench/myCPU/csrc/watchpoint.c /home/porterlu/ysyx-workbench/myCPU/csrc/sim.c /home/porterlu/ysyx-workbench/myCPU/csrc/disasm.cc
make[2]: Entering directory '/home/porterlu/ysyx-workbench/myCPU/obj_dir'
ccache g++  -I.  -MMD -I/usr/local/share/verilator/include -I/usr/local/share/verilator/include/vltstd -DVM_COVERAGE=0 -DVM_SC=0 -DVM_TRACE=1 -DVM_TRACE_FST=0 -DVM_TRACE_VCD=1 -faligned-new -Wno-bool-operation -Wno-sign-compare -Wno-uninitialized -Wno-unused-but-set-variable -Wno-unused-parameter -Wno-unused-variable -Wno-shadow     -I/usr/lib/llvm-11/include -std=c++14 -fno-exceptions -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -fPIE -I/home/porterlu/ysyx-workbench/myCPU/include  -std=gnu++14 -Os -c -o pmem.o /home/porterlu/ysyx-workbench/myCPU/csrc/pmem.c
g++    difftest.o disasm.o elftl.o exec.o expr.o gpu.o img.o log.o main.o mmio.o pmem.o reg.o sdb.o serial.o sim.o state.o timer.o vmem.o watchpoint.o verilated.o verilated_dpi.o verilated_vcd_c.o VmyCPU__ALL.a   -lLLVM-11 -lSDL2 -lreadline -ldl    -o VmyCPU
make[2]: Leaving directory '/home/porterlu/ysyx-workbench/myCPU/obj_dir'
./obj_dir/VmyCPU -l log.txt  -e /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/amtest-riscv64-npc.elf -s /home/porterlu/ysyx-workbench/nemu/build/riscv64-nemu-interpreter-so /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/amtest-riscv64-npc.bin
[1;34m[/home/porterlu/ysyx-workbench/myCPU/csrc/img.c:41 load_img] The image is /home/porterlu/ysyx-workbench/am-kernels/tests/am-tests/build/amtest-riscv64-npc.bin, size = 610892[0m
[1;34m[/home/porterlu/ysyx-workbench/myCPU/csrc/difftest.c:88 init_difftest] Differential testing:[1;32mON[0m[0m
[1;34m[/home/porterlu/ysyx-workbench/myCPU/csrc/mmio.c:46 add_mmio_map] Add mmio map 'serial' at [ a00003f8 , a00003ff ][0m
[1;34m[/home/porterlu/ysyx-workbench/myCPU/csrc/mmio.c:46 add_mmio_map] Add mmio map 'rtc' at [ a0000048 , a000004f ][0m
[1;34m[/home/porterlu/ysyx-workbench/myCPU/csrc/mmio.c:46 add_mmio_map] Add mmio map 'vgactl' at [ a0000100 , a0000107 ][0m
[1;34m[/home/porterlu/ysyx-workbench/myCPU/csrc/mmio.c:46 add_mmio_map] Add mmio map 'vmem' at [ a1000000 , a10752ff ][0m
(nemu) c
