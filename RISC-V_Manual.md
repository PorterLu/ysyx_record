# RISC-V非特权指令

[toc]

## Chapter 1 ：介绍

​	这一部分将介绍基础的非特权指令，包括可选的非特权指令扩展。非特权指令是在所有的特权体系结构和特权级都可以用的指令。

### 1.1 RISC-V 硬件平台术语

​	RISC-V硬件平台的是包含RISC-V兼容核的计算机系统。

​	如果一个器件包含一个取指单元我们就称它为一个核。

​	一个RISC-V核可能有特殊的指令集扩展或者额外的协处理器。我们把一个附着于RISC-V核，由RISC-V指令流控制，但是有额外的体系结构转台或者指令集扩展，对于RISC-V指令流有一定自治性的单元叫协处理器。

​	我们将不可编程的固定函数单元或者一个具有自治性但是用于某个特定任务的单元叫做加速器。在RISC-V系统里面，我们希望将来可编程的加速器是一些具有扩展指令集的RISC-V核或者定制的协处理器。一类很重要的RISC-V加速器就是I/O加速器，它们可以用于减轻重要的应用核上的I/O处理任务的压力。

​	从系统组织来看，RISC-V硬件平台可以有很多种，从单核微控制器到由共享内存多核服务器节点组合的数千个节点的集群。甚至一个小的片上系统可以被架构微一个多计算机或者多处理器的层次来为子系统提供安全隔离。

### 1.2 RISC-V软件执行环境和硬件线程

​	RISC-V程序的行为依赖于它所运行的执行环境。一个RISC-V 执行环境接口（EEI）定了一个程序的初始状态，环境中的硬件线程的数量与类型及其支持的特权模式，内存和I/O区域的可访问性和属性，每个硬件线程支持的所有合法指令，执行过程中包括环境调用所产生的异常和任何中断的处理方式。EEI 的例子有 linux 应用二进制接口（ABI）,RISC-V 管理员二进制接口（SBI）。RISC-V执行环境的实现可以是纯硬件的，可以是纯软件的，或者是软硬件结合的。例如，opcode陷入和软件模拟可以用于实现硬件不提供的功能。执行环境的实现例子有：

* “纯裸机”硬件平台，硬件线程可以直接由物理处理器线程实现，同时指令可以直接访问物理地址，硬件平台定义执行环境从开机时启动。
* RISC-V操作系统，通过将用户级的硬件线程复用到可用的物理处理器线程上，同时通过虚拟内存控制内存访问，实现了一个多用户的执行环境。
* RISC-V虚拟机为客户操作系统提供了多种管理级执行环境。
* RISC-V模拟器，像Spike，QEMU 或者 rv8，在x86系统上模拟了硬件线程，可以提供用户级或者管理级执行环境。



​	